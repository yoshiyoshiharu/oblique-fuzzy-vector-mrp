import numpy as np
T = 7

# p = 1 fixed delta
    # [0.0, 0.0] , [228.5, 457.0] , [-34.5, -23.0] , [38.5, 77.0] , [26.5, 53.0] , [-36.0, -24.0] , [-19.5, -13.0] , [3033.0, 4549.5]
    # [-55.5, -18.5] , [-52.5, -17.5] , [21.0, 63.0] , [-97.5, -32.5] , [-190.5, -63.5] , [10.0, 30.0] , [26.5, 79.5] , [2084.5, 6253.5]
    # [6.5, 19.5] , [-12.0, -4.0] , [-136.5, -45.5] , [-40.5, -13.5] , [-64.5, -21.5] , [-49.5, -16.5] , [1392.5, 4177.5]
 
# p = 2 fixed delta
    # [0.0, 0.0] , [189.5, 379.0] , [3.5, 7.0] , [7.0, 14.0] , [-121.5, -81.0] , [33.5, 67.0] , [-129.0, -86.0] , [2170.0, 3255.0]
    # [-349.5, -116.5] , [-15.0, -5.0] , [11.0, 33.0] , [-22.125, -7.5] , [40.0, 60.0] , [-35.0, -17.5] , [-41.0, -20.5] , [732.0, 2196.0]
    # [21.5, 48.0] , [-82.0, -41.0] , [20.0, 40.0] , [70.5, 141.0] , [-27.0, -18.0] , [-9.0, -3.0] , [686.5, 2059.5]
delta = np.array([
    [21.5, 48.0] , [-82.0, -41.0] , [20.0, 40.0] , [70.5, 141.0] , [-27.0, -18.0] , [-9.0, -3.0] , [686.5, 2059.5]
])
delta_l = delta[:, 0]
delta_u = delta[:, 1]

cumulative = [[0] * T for _ in range(T)]
for i in range(T):
  for j in range(i + 1):
    cumulative[i][j] = 1

from lib import p_n
P = np.array(p_n.positive(cumulative @ p_n.A_inv(T)))
N = np.array(p_n.negative(cumulative @ p_n.A_inv(T)))

# Dの下限
D_l = P @ delta_l + N @ delta_u
print(D_l)

# Dの上限
D_u = N @ delta_l + P @ delta_u
print(D_u)

for i in range(T):
  print(f"& $[{D_l[i]}, {D_u[i]}]$")
